
Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	
	Если ЗначениеЗаполнено(ИмяМетрики) Тогда 
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		               |	prМетрики.Ссылка,
		               |	prМетрики.Наименование,
		               |	prМетрики.ИмяМетрики
		               |ИЗ
		               |	Справочник.prМетрики КАК prМетрики
		               |ГДЕ
		               |	prМетрики.Ссылка <> &Ссылка
		               |	И prМетрики.ИмяМетрики = &ИмяМетрики";
		Запрос.УстановитьПараметр("Ссылка",   	Ссылка);
		Запрос.УстановитьПараметр("ИмяМетрики", ИмяМетрики);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда 
			prРасчетМетрикPrometheusСервер.СообщитьПользователю("ru = 'Имя метрики уже используется в " + Выборка.Наименование, Ссылка, "Объект.ИмяМетрики",, Отказ);
		КонецЕсли;
			
		Если НЕ prРасчетМетрикPrometheusСервер.СтрокаСоответствуетШаблону(ИмяМетрики) Тогда
			prРасчетМетрикPrometheusСервер.СообщитьПользователю(НСтр("ru = 'Имя метрики не соответствует шаблону [a-zA-Z_:]([a-zA-Z0-9_:])*'"), Ссылка, "Объект.ИмяМетрики",, Отказ);
		КонецЕсли;
		
	КонецЕсли;
	
	
	Если ИспользоватьПредварительныйРасчет Тогда
		ПроверяемыеРеквизиты.Добавить("СрокДействияПредварительногоРасчета");
	КонецЕсли;

	
КонецПроцедуры

